require 'pry-byebug'
require 'benchmark'
require 'set'

# str1, str2 = STDIN.read.split("\n")

# test # 2
# => O9C <--- result
# => S4g <--- but this works too
str1 = 'r0I9ApIjCApwv96pzTtKDQCUUjzS4graebhgHdzgH9MvHZrwcKn1A23xSObg0DF4XlSF8p9WnhFVmUKcKVB59Fmhq5OKGfQio8Gj8Gra2klmkehlyv90zKqZV3nxXffCbdsrzlWbysRuz7ksdHsP4bOUUx8huWkrwwVLyZM3sFIv7U6j0EHDxVHzv3B6ykFZfdBgCHLX5Btq56Y1gLpz5SuQCcSSGzLOZehWYftDivEQppDOCjfC9BYxohyDYPSXCy5YdoFYw8FLhuLaeFAmdDcRXCJHdbLU0jcvR6rq3vkJMz4DG2SRDdenjds7Br9k7OfuBcjC0gL0Hfrq0RWlo17gL7aNleMi0B1UINYPsCjrDETsl0PVezYGEUdOBTPbvZf3XZqYZE4xZUWz98Cd9kjh09XoyYFHBDZMN5RKDRjL8UT7TmgkKykLVuWnvvyPZ3AeHWpi31FRc9GaKdUxGTxRO7lIhMyRONRowPz7ppgxas0T3YHkxEDENFtYLZbxoOqEyThwDKzBvDBFP4SRlLilOnrnax9O86dZ4HmWgTNp5UIU3PfpcgxsaGKd9bR8fv9yyWyJe8895FVzIcbcGlHjezz4cam4XD14MxoUIwucp1s8A8hm6EO0Nqew08FkGxJD8NfUxDSeZNhusnw1hdXzSvRo29V9aki0bM1iW2blyTSpeqYgqxcXkdfnEcZZmBvtB2990A53S6x1RTXPqMx9ZPKTR4gcmqh9U6PmJD3dHwluCtuX2Hm3R774b0dSo2JnmZmqhPwgSUpwXtGBlICVNMf2qRfqIkksgQXZLV2kiZCLJwpgSRVuIW1PCaNkFZqhkj8SuFBW3GuLBnWwkWHaylo63hu0bepHTqmpop3e4XJ15qZAMal5clS6cSTVX2zNXkZjLZVSlgURbqmxuU94IdO9COVCoyRBXPfMIaABS3Ugqpgw3NSPQ7P19Tibas8DA70tOtyEvqBsdonnP5UUzOf1baliY5DH5PFrHQgH1IeWa1Aja0RJ00I34Jsc'
str2 = 'VtVCT9h5rGT1eaUsQEDI4KtsWyaZgk6NbgrAEI3Fr78fHPoh3ozU37dOR7nrH6dB6mNeVtrjaurIbldoVnmqppyBIwwJ8pUACqyZCpCI2SyA4algdrOHtIDWcYuG909KqJJn5Msbd5doIahLAohwvuIzkgOwPJ97UOXT9eBaV78skEgkQ7cN2JNOu5kpbSUCtYC5HCCymg6ErULgOpxQOVeoqr9KLxwliaVJ57vdAagJX0C416i4dddGhXm8eJrPHZG0tMCbX2KHwh4jxe6dGkgokJ4GUNZH6F7yIgQmU2ZDdvM48u65MAezNnhkUt8szT3sldNiEi70unGwxYmNzjUxxSrapYx84ITyA7PB26a4VvtbyovLuFPnqgqerMmMwfGnARFPJkW3pLXWqR2EkTSVWd13gztXVfvhiTfJU3SCodlD8gf2MddMwPNipmygSsZ2VErWP2hiWFEYugAj6EmqV3ID9vV0bgaOYaHfNoiGAoTwyhc6ySqwQpKqPSt3vEiTwdo2iALXtCOl4wdeeq9P8Yj4Vncnl6j7WezczZ613piZsQPutnAQHXOVyh0HT9mVqPyqO9CLHwt1tiqvSDjoPWuHYUwTqt94fRCwxOuWevJQiirJ21T26BhexlKnqm7MLEd4pRjBdHk9t6eomr2M6t5miWRoro6VPzIp06UInRrf5DZu0D0PAcArQVq6xrY6Z2MjbBXXBhJt0Xndh7abq0Qf7S4gHNmBXehrMVrhqsM7YVTbvqzioFUIXypcnH2pdyeEatbu4nXRvnAjyYDFRg0SSJyi8yPL0VDqmZgz3pwL5aJKb78GL57GoOdad1e0baOtslfHrI4ZgoYeP5xFHqRM9ZsAgK9YjlD0TTJed3bXUvOncWmJPhL0sI4wJ792nr8BUayijehP5p2D6tYF0FiunjANLtOYmIJ1x7hNJgXkwAYRBgWNk4M3hBWkyCYNNZWUtytbmRclVzbWvVMaKWUjAU5W2tYbK6CDJy5BvVrHYm2kvtEJzqHZU9MF'

# test # 5
# => GZiy
# => qywp
# str1 = '2LNwtbQSIcc22HK3pLhdO9mY4hjyrcG0JC7PR7OLYNyuD9jWgXpob1FEs2PGDnCWl0yWb8aFpqivFK08HD1hczKSrbVDhnHsChao9AyPOgYt1zFCDiUi1HG2YWY9Tcdtz4nqTsjB1GeIRtVluTGCcIjlI2nV4AFuu9WsSbcMBkc0M41H4HTWheNPAtvrsabjH7XP8haNRrtvzmssAGIs5qzflPq5lfD8FoHdPnITVFdtsOKlm8RNVv65OfBs4nyDBiIJTShuZJhDrbqxzb6pc1OQq4wfDFrk7UPqQsdiWhDOrhQyzKThXulkTJersM76KNf3y75JaQkr8FuQ7sOteHZgB56OiOu2wTdwKpyGYJBbcpAptUNcOdiTi6hKbkUecxjVt4MAITWEQXMJr71zhP280TgrLKcUoJJPtPCXqvP6VvedeNhK6fKYHvVnyFDf6hASt15KT6AEl7kHVMLKkALaobGEDdvGVn92lsdKWL9Ie8C6odBJlnfuKArtx5JhWjd92rKvQlOlomkZ9G4qmDAE56YxUOn0ITvrQKw70xwcPl5EikZuqBu9Nx0wyGP4qNqvjhK5NN8L2hUf28kVhypnzABdl4oCOlw4y7ojGXgqGls86p09OwX6V337wet8rBQUyQqXvxBgsZdsqX46YP8VFHyttBreEmq5JaPEO5SK69lG2PiuvVIoRlln6EtMpMX6QXIMDaLwWO4GfoNfQVqRtb5wsMssYQrad4oVjQFl6wtDXZJLvWmLPSLRLJHQAmucqhyTuFaaadpO21I3JbYhf9hJBCE8Fa03vjD50d6NU86Ddt2GYenwhw2ZdDsQ39Hfsv31ma4ywCVeMrx9BZItkhyGY4r3kxBIHB8d5w9kC65jvzhPLKKZixMbW6znx93u9AYhUc1Twfnj3hte21ARDjk30VpoSA69ppykmCtJ6cNzZNbGCtkSn9MBLUtcGzDyek0uusjyyy42HOVeEvfuO84nJvK7se3AFCNtNFvSMRv6HXz87b4tE3nz5sjDPzkcV7fTWjTcyyUb0jB4rj2ID8iMjJRoI9xUF9shQqZQLTbUqywp2TFNUH2cO0AUVQR515fdZKw9G9i9J7XNPFdJm7GC7vqu7HZDWUJVGgzrqMBumcD3DY24oKySh1LkmNg2rpz1g0uC9BLiY3RGL2LbSUJzSENUvdC9OgzYIk5ZojbbPLtZzZW9Vm7q3XWjGQgzoSODGCEWu7CtZtQkMMvk7ckf4P15v89Is0xmjRrx1k3T5HqOxkDCXpPPqOpn5o4bqt8QeRb7yblzWne8GOdF0L4BUxh5zqK60oN1KXo1SHlPAFEzuqZnFNAGzeB3cGRDSoKD7CBH4ReGswTGCxQ0OzbncGoodFESVwG3gcr77vUPwU9MHZCeDpF7JaUzCScsTkkjtzxgaYLGMr97QKTrKXQbOcx6mYFec7mFzqC45xHUpChv191hR3CV3eSwIfjUjnH46mL1k5FvKnOTNU8ZAthX1bFozCdW7353WyvE3MEjBuS1RqE9G8g0Tkc57IvUzrv0s9eGRJwBnXGYxexmoGfLfPvMlWovrkOicvZCHBXXgIvNSmJ73bgRjiDlHGxeuW14Kb7foAMqv942qwXeyO50oGsuKlHakp0lwT4uo2isIGe14DNtMwuM8zEkiveSBlgDelB2KyP4KLcR1PW6x8ueF8O8H1LTw5XgLyFyBXaeyGLYNaIwh3dFY0ejtCAzLbOhGfMwDZcCnlUvyB1vesDPLt29sIX9PiD7GwxchxN3V45FhwBrCvPHzJCbUIzZr3KkvwogjN22B35EqA2bsnei3TVzHFo5lBmnR4OVnRzsX9CzIgyw8mOmD2D652CTRqloEwArH84Eji58p5THMW7Wsys1baN5qXnPBAiSmzFBKkxFvBbLLx8lyMm6ZHYuycJ28QWwLHd733xeTcHkQa4cASukYXedi56HwGsDnK0ryg1Gj1cVt0ZcsNfnl4YUNs1oJU2RYCApkAZMMt5TXooVSL0C5pvCLaTmMO1tnohlGTRZKygPnne3MVjmCke5VEtmNfI9jDZnR2YoIGsAAu3kJ24T11EwNidmaGXkg8SCXkni2VPSXjKWJHKibBkZjiuwjdZLo7ArP7L796IambqD6tp9Qjbi3x7g3k2RR7LV4ru9I495g0I9oPxr3gBc9cQqEXtMatWfmrAjOkRY7RZ941dlhmdvWrHVBI6ZYR7jmd072EMOcoq3fAYk8bp2eywMCwtbFOHEl8V5clEDgsYkDkHfc6RTEk7x91f5uiojVkUcTjxvp6elpYNLwxI0ZRAf0WhdNTZ2IaBQao1LhACvG1oEbIm8X71XB8IKbWJ2t3zqsWlsiuR1c4wl2ScpKiopzF1OKtNSy8kZ5F3Q05NfDitGxjDnIGQh2Om4JmHQKzp8jRxbcHyR5tozrmNmvXcTDmAnVFSMZ3e0r8VSNpI2O6meKysDuXKoVFrn1IdM4pkwvQ9oMbYRj1piUg020sxFavsukDIUCSH3wGlq5TfFGZW7lEMyA6C6lhsBkfkmFfylv4VMJcngscSwK9rcMqrGc2yeB3qmZheh5sdlr3EZsqLyeWS6becvZ1EIZHJQzlWiptu621jODUrB88KcfUY7LnlTIqYLpgveTiEXpoveT8q4luv8CqqncAo088zEaHKZX14kxW47hZwPHvBBroZwjPoW4OmXwe1djODhIWAbFpKTZIk47qxSZABmTUcOHZ9kDB7ziaQszmfvVq0ozYcuAyX6h1BVbJI3zeOTSXXsHFx1I7OJG6MWYFLnxrfRphmI8Q0S3tcrDIjLeOHs8g4p5ipyLwc9CewvIUAmFoPyPWHtArvjLopmQh4b59xQXBuEcPXQV7AnMvammq65BCFL1cV5FzIyTVmK2wy8SbT37DswEb5Y63NORhdPq2VvHykGZiyvrF53WDqcWCAiW6u802Zaxgf1cY9ilgyln5xY52O3jqzLA0kEYtxfvhduIB7lUhAkG6lC15HlPjC32afj0GfLUjbjH9ppQ1lJXmIusUPKUaxSrKT32fl4gRDJFAy7gCbueqxowLjpIrqtb2UV75qR5ShFqJZYdC1PSnvPUwFlwQ9BPWwFUs0Y0TwpbtOyNBDwZWZVzTwnCnJXXyVcYqgPsKfiF9weo0iJhiQHcF2Sg8REVDrfY6oUX98YyfQAm3BoUtFZUoUA2aRAcIKetUf42Cp7xA9SsZwCQwvD3GsHX0qOZS2AW8jNbQIQHj9azBCusno0Gqr1s3TJPys0SfFhBAS7IY38HbC8Bt76cVRpFstljy8e4YUFiUcbFfEqz9ZL51jIr6o6n3upJjBAIgLNrl4jnEGNRsQHNjfamt2fR0YHLz4Toy6Ku9jxgGQYcVHzaQfNQ6E1eWXNOMssHxTgpVOUXTBYZ0WjBodMA1f1tFM2DUKFOhlCY0cVoarYJyG3usSKoQOefqWaB84fhDn4gPYpl1u1IIeEooHRQGacKxjFtG5DOY2BPjZ2kexPGAPN3wd3yOD1bUdUf3AG7QYilfdDSXoRZclBqnEFluGGEdQPKTBBNtab5EKGNGNuepMwSWqQOmXakoN6xiIoKVyWkkQbVjRv10JNHdLwO6RSWxG8obnDv9yJRGVONafVXRMSH1Zo2QIUbxPJoCmseM5fWMiviDAQ50rvaViBXQ0OTjPxYj89lN1LV2sDp2ofnoIpFhxLaq8jVsQ51Fq2eIVDiLtuZpNBNLHXAKQrRNqugyQknHHqvPWuj240bpkQ49voFOFVFH3saXj48vv9GLUi8u814XOo1rOmcC0639qYneopJ4psTLF0bg1U8PCwnX1XDMOpVZA5UHwe9YOWZ1WoCjkg5SjChZN1E5pQfFHRZuPPy2hLhsJ6VL5JlGwaKveEjIEq9UeSJHV1sNORPnkMrldNK8AWJnEP8ZKUpfHood50kvykMKqYqIo1egGglTPBtIAqrpH8Ny6N81UaIgQFBFh0aVHa3tjnAM92ybS0XSyqw0Bv4U5LFQGRybK5osPsF3bz3u7nVTsanmtBffgeXUfWuFie93reNJaZ5YzaTyx5U7qO8TrH3pwKGbV7tLPm8Zow63jQLocdtbwuA2Cn4OSfTvtniPG8Z7KXpDer07jeS09iq3b4Fzs9n74z27wGYnSLrz0i4XECawkKwpvr2mVuF3lASuGyW9pOPlzW3wdQWljLUJhlDgD24YNqDySlhQcxMPvlENYe93BUqeItNl8HSRT8mK0nM7vMi9GrAy6AUPjOWy80FlbW3LHF0suoTBZNTE6jYlwoK6ZHdjkAFvggxrowzFDK1JhQnxDrq0EZCTHfTn80UVH0p3TdArpfWcg7GCd5VRjpkbnDAVJioj8rlYWA3qfYM2BqENOkKpXom7g0Re3VGWXX89XEbwMRffyEA2YIefWCgZDMPJFuf6MI0s31sR5bcjMeDBLsIaHOTeuFqWy6G1Vt8XTYBwJEJKLCPehi0iXPWzhqoPdQr3mqnXo6gZVCLBb1wq98Ifi0IXI3fE962Bw5RD82u5vgo6RXPbrA4DLly27kc4Le0mygqL2qdLUNgUFiWDWokcVjgPmX4kXcz5Z2LaUtsjPhpVm6RtlN9iJRnpVSUUqhAZFxsJDVfPhrBX3JgspLtmr5KlFBdoViEd4Bn0NvNHp6fIy0xkjAR8PpF1kJMpl19pTcny8ryGfFri1DZat107ueiwGV84ymrTP1s02EYfHoG8ocSvL8hXxU1jdW2EJQ5w1TZx8UGIAf8v51JhBFzJjs75bdPIfqeTou6edg1gF1M7c4T2UVgwAQYycTH6mhl6vJug0ok55RhCjBo7x9J2Q0IpC7yXNP0QrdhkKtqY5p7g3SI325uiWQPg2sg2216KjxncwJ1nWx7VqqFqHw4drQo6j1uOarGdpOHCoAf0H7rdo4bQbyaWGQhmsKQNWYa7TuM0db5NMTuoYMhpIk61q89wmkcFYbcgrodXloJy9vXYX4lCTtVBGLupRN3GgGrhJjJ8qf1UixIt8iYJIfQYnV7uvhclFuEBekqEWUgotQkUuoed3NO5YcbI3bNlrMqN9yuwU56ovsbrSdJRQat9IoX8nRkwHNoUFzWkTrlb1Fo4g8evCDTdkKkNiUzadc7BF0jINq0wag4Xj3mmUP2dxwNPuywC94ytiyZg6I7CGsz4o9s1DGOgCxvHMatR9NN4RVcx6H3P3cPBRqFLVcCpppkQ3IAXBWNLSt9SM2jHRhwc5YnOJ4dv5OFTzhTckxt2ZtLFRr1QzGYVS1wdhDvHt8IFzpIbqGVH0mHSZR53eH1otoWy5ISaloWOScXGres5NURTPlQdFUmsbBDrtbQqCOromuoir6F0OCHRuPHWv1p947RpaassauoOCAvEiWCu8Qe0ppoKgFWCY4o3ywqlxQjBIAomdIHBLDRFLqLIJvO6mFIRM0fhgLa9qlkIk5oDcYrY4Jc2471APWkhcJaRJjUebA06ZzEr8wllF0V0Jyf1JWkIxRlKgqYQpBEoI8wsMcG5WUpscWMJOmkBka81ZXri8IjVhqbPAxDIanL6XXk1GHN4DRPlgJebYXhKWpPWKPFEQ4rjKeaGIL2mxi6qFYLSKT0lJgIJwNBSy5q4S4PzmGziEW5y1PMHbRx94Lm6ngzRLuGizE4Dj1m5ohUgzUo88sTXC71ydYpoFEZWTcG279QFCUVPLTrVwrpuhN95GFaCRhmIINZ6SBTGHiCFmwZ597Z8zrdTRkgx0lB91ku9WVe5UdR1j8qNxoZeqjaLXP1ktSb0uPEPjHe1ZuHOZ5x5JCacJWGOFCJikLJQo0ib8Sc0esURiiOlQDJEVnk5bUrMEBxQjmFh5mU1Muc7cBkcNHmFwrHY1AUMuGbcSxChppQ3k5QVUhAQwCVkyCynH11L3KzIDukaJ0MrqVvKzugOU97cVrwTQgHIQgU5QwbWTXhIjvkJE1nrD2SAaqhGk91tuxITy1tbLEe4RmFlvOA2h65eC32hf5qoWpfKIyi5V7ukh4GylcBp8uW4M1ehK1yHuZ9H0Ke9lpxDAdWisnnfLZlOy2AessyWVxCSpVKHZ8MbJi5VwRYRwxqNsCAGsyeSGdRCCaVRwjUuj2mfPDwMvtvcAb9N3Fr64ecWlAP9eV7cloifnkFPNKyFrOUfLAzbl4tnhav85aeEgp9bAuamsucsAwnEb7rtgTheirwtx2UckPjALZdiIqyKd4F0KrHD6rhToCeDO069EiSNcGLsmGPjX97vlj8nJkvZeGFn5xNCPFi8DzYpkyvLFOBSsc65pNO7Fxfecm6hY6ilWgmAzttJND90IabMOJsTW7aaAQn0rkztLySywLLv30kqO8YDM39msU0mKiBr9Lm54Gmj7VXveLukKgQ1oTMAqaiLMwftUkJezmXYnptx1X9vKWncJEkMKyxIGgrtdWlfIW7X1VDQB8r3oHN20T2kPFLZN8yYY2CUoP2mfV2Ia3XaaIMaBo0JHSUJU1TdIM639Jgdd1vz0n8DHtAmeQ6bPbXNN5bFJHkKVwzcpgxR85qYvJMimYOwUb19wZ2B9o0vOrpZVqXy1EgIvrBEBMw79QxDsTiP2rCa2O3VgVCzJh2Jlmh1wIj0cIEMApRQlZYJB95G7Ypez3eUFjmZbPcrE6uuk4IJX2aSmWn6ZQcEBS2PNqTzK7xwoI3FZC9alcvA869ToYIapdT50GCtVynHoHGdTxiyefc6ykl039FyIDCCwuOUcACrZwnxR1sTR7VQfkQt6GV65Cz5gF4486nCUvWTqGWRwbZqyH4VCCx4vjXXjLWZpaKlspwohMInbRo8jV7fw17uLGk7HPZNf0RhC6rXXhu2pjS0PTrGgccnkapXgdeZrFEQEs7OiZzPEmENLYZ9i20Ez0kmfYx8kjK73GVps5t5C7Qsd5Iv9Vzfru0x3YHU2zoSw2SHElKG4upRgXWx7g524HjHrEsM04uAnX1dG1pFNSjrDUL5bkH6TmycMqdpQl7xsumCpptNkuSPSNT27R8R4IeqmOzahHk8knOa8HrWAHnedoqhCytm8h7LbfWmS6TVdTIVxGqPcKexhS3DXe0MmNGb6lIF8GQJgFMmJ8yIUeOBPHwhlz9aBhijSrhyOBCQYCetY1CPyOpBVNt4etSJ1pe5gX39h8wWyR3YKnhXJZ1Ucs3I9Cnj0Rwk7cFq1lw6rt3pspL8eaXaUIsoQTIP3Kg5QXaVpF4cfYhE2I2ra3oS8iN3OQ5xEw1te5qOVzzjH3MU3FtEZhAsCgVXzy3qI950lIb55XmNhWA8tfJX4KJl9LqN1ibxYlRyZr4Wa9Kfg9dZ45OzSXJRCfRIFYKO1rAnSjU9MB9HC0vW2VRAfZeDi0oKTdwa72t5pTMdAjSAZTplfpxkLMiqkm0pgROXtRw3N8dMxwXu1K7Sg5RVpLLAkbghHhPVhCJaUvyLtzICuNwMuTPmb7vXL3cPuOh6Cl4sIWIIsrBpfVp93hXF7YjVt9jmsraTiuqUwZnON8eRauw1e1HGzeBWFCgCYa69BfHoWDoxZQxDTzGzWVuJH5HVCdKCXJxWte8Uy16VBDwKDcn7u1yZCqp3zPR2Qje1DrMhjqu7Io2yXz9FhnE2Pks5hLnwlzqISjpx3lfrY37SBu4AcU9Sv9ztIuMqNxBBgIu5wHbvAnqNlKhEqJZYkGkFXcnV9BuRmedQrKuvfCsWrf48QGcPFjrHieEmMlCFjFix1jjUIRyOlxLXpce5DdF5NF5Bt7UWn7hj1S1AXZP2wgYyzDE8oPZUZw1qhyeBleKiiWuGJWL3eJIYGjxPRvR1lOvIwNBMfOzKCyotTlzS78H0yzKZBybBQ9SJ2XQgwKk1HYpLIR1Cf7koBsmLqAO68mXiCRwoD91GsxElavwUCOC4MXwOwpKMqfsdGWdtjFzo5OKIHTql14F1AOLEyF2WEwm7cHpB2RPQ0tpo61yQnWL66urHEWT4oSmF2cz4OBVO6iOMKXqmC8YdhkQIIFZmVHbpC2548lqElus9AmINhWREbsM4wHIepe3M570NcJBPv4ikSOdF6NYyIGuBRHU7Z787hgkoAcIvDfh8YV8PgIPMpWRkFZRhj3bEH1l78yqarSfCU4ad18rmJ8a7rN50qPUaI7uFQVyrIl1ELLIbBqhWDQvDE4ZwgWbcpr02Fa7ioPRNUXYfOjv1ws2EsT'
# str2 = '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'

def f(str1, str2)
  # commented length restriction to calculate for long case
  return '' if str1.length.zero? #|| str1.length > 4096
  return '' if str2.length.zero? #|| str2.length > 4096

  return str1 if (str1 <=> str2) == 0
  # найти все общие вхождения в виде массива
  # сделать из массива строку
  # сделать словарь из этой строки (из все общих символов)
  # найти вхождения из словаря в строке№2
  set1 = str1.split('').to_set
  set2 = str2.split('').to_set
  list_of_intersectional_chars = set1.intersection(set2)
  intersectional_string = list_of_intersectional_chars.to_a.join('')
  intersectional_string.insert(0, '[')
  intersectional_string.insert(-1, ']')

  regexp = Regexp.new(intersectional_string)
  str1_intersections_only = str1.scan(regexp).join('')

  sl = (1..str1_intersections_only.length).to_a.reverse
  sl.slice!(0)

  for n in sl do
    for i in 0..(str1_intersections_only.length) do
      if (str1_intersections_only.length - n) > i
        return str1_intersections_only[i, n] if str2.include?(str1_intersections_only[i, n])
      end
    end
  end
end

puts f(str1, str2)
puts Benchmark.measure { f(str1, str2) }
